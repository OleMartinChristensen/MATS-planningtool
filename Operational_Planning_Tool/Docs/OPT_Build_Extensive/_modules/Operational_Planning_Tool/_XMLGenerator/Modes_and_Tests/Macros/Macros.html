
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="python 3.7">
  <head>
    <meta charset="utf-8" />
    <title>Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros &#8212; Operational_Planning_Tool  documentation</title>
    <link rel="stylesheet" href="../../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Contains macro functions that represent parts of or a whole science-mode/test.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">importlib</span>


<span class="kn">from</span> <span class="nn">Operational_Planning_Tool</span> <span class="k">import</span> <span class="n">_Library</span><span class="p">,</span> <span class="n">_Globals</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="n">Commands</span> <span class="kn">import</span> <span class="nn">Commands</span>

<span class="n">OPT_Config_File</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Config_File</span><span class="p">)</span>



<div class="viewcode-block" id="Operational_Limb_Pointing_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Operational_Limb_Pointing_macro">[docs]</a><span class="k">def</span> <span class="nf">Operational_Limb_Pointing_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Macro that corresponds to pointing towards a Limb altitude in Operational Mode.</span>
<span class="sd">    </span>
<span class="sd">    1. Set Payload to idle mode</span>
<span class="sd">    2. Start Photmeters</span>
<span class="sd">    3. Run CCD Synchronize Command with calculated settings.</span>
<span class="sd">    4. Run CCD Commands with given settings.</span>
<span class="sd">    5. Point the satellite to a limb altitide.</span>
<span class="sd">    6. Set Payload to operational mode</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (:obj:`dict` of :obj:`dict` of int): Settings for the CCDs.</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span><span class="p">,</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="n">_Library</span><span class="o">.</span><span class="n">SyncArgCalculator</span><span class="p">(</span><span class="n">CCD_settings</span><span class="p">,</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraOffset&#39;</span><span class="p">],</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraIntervalTime&#39;</span><span class="p">])</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafPM</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSynchronize</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span> <span class="o">=</span> <span class="n">NCCD</span><span class="p">,</span> 
                                                 <span class="n">TEXPIOFS</span> <span class="o">=</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span> <span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">,</span> 
                             <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span>  <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>


<div class="viewcode-block" id="FullReadout_Operational_Limb_Pointing_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.FullReadout_Operational_Limb_Pointing_macro">[docs]</a><span class="k">def</span> <span class="nf">FullReadout_Operational_Limb_Pointing_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Macro that corresponds to pointing towards a Limb altitude in Operational Mode. </span>
<span class="sd">    </span>
<span class="sd">    Has an dedicated set Exposure Interval to prevent CRB-crashes when transferring very large images.</span>
<span class="sd">    </span>
<span class="sd">    1. Set Payload to idle mode</span>
<span class="sd">    2. Start Photometers.</span>
<span class="sd">    3. Run CCD Synchronize Command with calculated settings.</span>
<span class="sd">    4. Run CCD Commands with given settings.</span>
<span class="sd">    5. Point the satellite to a limb altitide.</span>
<span class="sd">    6. Set Payload to operational mode</span>
<span class="sd">        </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (:obj:`dict` of :obj:`dict` of int): Settings for the CCDs.</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        TEXPIMS (int): Exposure Interval [ms]. Note! Must be set very large when handling large images, at least 60000ms.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    
    <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span><span class="p">,</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">Disregarded</span> <span class="o">=</span> <span class="n">_Library</span><span class="o">.</span><span class="n">SyncArgCalculator</span><span class="p">(</span><span class="n">CCD_settings</span><span class="p">,</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraOffset&#39;</span><span class="p">],</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraIntervalTime&#39;</span><span class="p">])</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafPM</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSynchronize</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span> <span class="o">=</span> <span class="n">NCCD</span><span class="p">,</span> 
                                                 <span class="n">TEXPIOFS</span> <span class="o">=</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span> <span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>


<div class="viewcode-block" id="Operational_Sweep_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Operational_Sweep_macro">[docs]</a><span class="k">def</span> <span class="nf">Operational_Sweep_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">pointing_altitude_from</span><span class="p">,</span> <span class="n">pointing_altitude_to</span><span class="p">,</span> <span class="n">sweep_rate</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Macro that corresponds to performing a sweep while in Operational Mode.</span>
<span class="sd">    </span>
<span class="sd">    1. Set Payload to idle mode</span>
<span class="sd">    2. Start Photometers</span>
<span class="sd">    3. Run CCD Synchronize Command with calculated settings.</span>
<span class="sd">    4. Run CCD Commands with given settings.</span>
<span class="sd">    5. Point the satellite to a limb altitide.</span>
<span class="sd">    6. Set Payload to operational mode.</span>
<span class="sd">    7. Start Sweep of satellite.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (dict of dict of int): Settings for the CCDs.</span>
<span class="sd">        pointing_altitude_from (int): The altitude in meters from which to start the sweep </span>
<span class="sd">        pointing_altitude_from (int): The altitude in meters where the sweep will end</span>
<span class="sd">        sweep_rate (int): The rate of the sweep in m/s.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    
    
    <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span><span class="p">,</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="n">_Library</span><span class="o">.</span><span class="n">SyncArgCalculator</span><span class="p">(</span><span class="n">CCD_settings</span><span class="p">,</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraOffset&#39;</span><span class="p">],</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CCDSYNC_ExtraIntervalTime&#39;</span><span class="p">])</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSynchronize</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span> <span class="o">=</span> <span class="n">NCCD</span><span class="p">,</span> 
                                                 <span class="n">TEXPIOFS</span> <span class="o">=</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span> <span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude_from</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude_from</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude_from</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude_to</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="n">sweep_rate</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>


<div class="viewcode-block" id="Snapshot_Inertial_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Snapshot_Inertial_macro">[docs]</a><span class="k">def</span> <span class="nf">Snapshot_Inertial_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">FreezeTime</span><span class="p">,</span> <span class="n">FreezeDuration</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> 
                  <span class="n">LP_pointing_altitude</span><span class="p">,</span> <span class="n">SnapshotSpacing</span><span class="p">,</span> <span class="n">Snapshot_relativeTime</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Macro that corresponds to pointing towards an Inertial direction and take a Snapshot with all the CCDs (except Nadir).</span>
<span class="sd">    </span>
<span class="sd">    1. Set Payload to idle mode</span>
<span class="sd">    2. Point the satellite to *pointing_altitude*.</span>
<span class="sd">    3. Run CCD Commands with given settings.</span>
<span class="sd">    4. Run ArgFreezeStart Command with *FreezeTime*.</span>
<span class="sd">    5. Run ArgFreezeDuration Command with *FreezeDuration*.</span>
<span class="sd">    6. Take a Snapshot with each CCD (except Nadir) starting at *Snapshot_relativeTime* with a spacing of *SnapshotSpacing*.</span>
<span class="sd">    7. Point the satellite to *LP_pointing_altitude*.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (dict of dict of int): Settings for the CCDs.</span>
<span class="sd">        FreezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">        FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        LP_pointing_altitude (int): The altitude of the LP [m].</span>
<span class="sd">        SnapshotSpacing (int): The time in seconds inbetween snapshots of individual CCDs.</span>
<span class="sd">        Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the first Snapshot is taken.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_affArgFreezeStart</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">StartTime</span> <span class="o">=</span> <span class="n">FreezeTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_affArgFreezeDuration</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">FreezeDuration</span> <span class="o">=</span> <span class="n">FreezeDuration</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">CCDSEL</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">]:</span>
        <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSnapshot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">Snapshot_relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
        <span class="n">Snapshot_relativeTime</span> <span class="o">=</span> <span class="n">Snapshot_relativeTime</span> <span class="o">+</span> <span class="n">SnapshotSpacing</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">LP_pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">LP_pointing_altitude</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    <span class="c1">#relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>


<div class="viewcode-block" id="Snapshot_Limb_Pointing_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Snapshot_Limb_Pointing_macro">[docs]</a><span class="k">def</span> <span class="nf">Snapshot_Limb_Pointing_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">SnapshotSpacing</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Macro that corresponds to pointing towards a Limb altitude and taking a Snapshot with each CCD (except Nadir).</span>
<span class="sd">    </span>
<span class="sd">    1. Set Payload to idle mode</span>
<span class="sd">    2. Run CCD Commands with given settings.</span>
<span class="sd">    3. Point the satellite to *pointing_altitude*.</span>
<span class="sd">    4. Take a Snapshot with each CCD (except Nadir) with a spacing of *SnapshotSpacing*.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (dict of dict of int): Settings for the CCDs.</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        SnapshotSpacing (int): The time in seconds inbetween snapshots of individual CCDs.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">CCDSEL</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">]:</span>
        <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSnapshot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
        <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span> <span class="o">+</span> <span class="n">SnapshotSpacing</span>
        
    <span class="c1">#relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">def Custom_Binning_Macro(root, relativeTime, pointing_altitude, comment = &#39;&#39;):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode5 and Mode160</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;Custom_Binning&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafPM(root, relativeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>

<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">def Mode1_macro(root, relativeTime, pointing_altitude, UV_on, nadir_on, comment = &#39;&#39;):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode1.</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;High_res_UV&#39;)</span>
<span class="sd">    </span>
<span class="sd">    if( UV_on == False):</span>
<span class="sd">        CCD_48[&#39;TEXPMS&#39;] = 0</span>
<span class="sd">    if( nadir_on == False):</span>
<span class="sd">        CCD_64[&#39;TEXPMS&#39;] = 0</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafPM(root, relativeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime,  Initial = pointing_altitude, Final = pointing_altitude, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">    </span>
<span class="sd">def Mode2_macro(root, relativeTime, pointing_altitude, nadir_on, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode2. Exposure on Nadir is enabled.&quot;</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential LP [m].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;High_res_IR&#39;)</span>
<span class="sd">    </span>
<span class="sd">    if( nadir_on == False):</span>
<span class="sd">        CCD_64[&#39;TEXPMS&#39;] = 0</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafPM(root, relativeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>
<span class="sd">    </span>


<span class="sd">def Mode100_macro(root, relativeTime, CCD_settings, pointing_altitude, ExpTimeUV, ExpTimeIR, comment = &#39;&#39;):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode100.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential LP [m].</span>
<span class="sd">            ExpTimeUV (int) = Sets the exposuretime of the UV CCDs in ms.</span>
<span class="sd">            ExpTimeIR (int) = Sets the exposuretime of the IR CCDs in ms.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;BinnedCalibration&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCD_48[&#39;TEXPMS&#39;] = ExpTimeUV</span>
<span class="sd">    CCD_9[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    CCD_6[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>
<span class="sd">    </span>


<span class="sd">def Mode110_macro(root, relativeTime, CCD_settings, pointing_altitude_from, pointing_altitude_to, sweep_rate, comment = &#39;&#39;):</span>
<span class="sd">    &#39;&#39;&#39;Macro that corresponds to Mode110</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude_from (int): The altitude in meters from which to start the sweep </span>
<span class="sd">            pointing_altitude_from (int): The altitude in meters where the sweep will end</span>
<span class="sd">            sweep_rate (int): The rate of the sweep in m/s.</span>
<span class="sd">            </span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;BinnedCalibration&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude_from, Final = pointing_altitude_from, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude_from, Final = pointing_altitude_to, Rate = sweep_rate, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>
<span class="sd">    </span>
<span class="sd">    </span>


<span class="sd">def Mode120_macro(root, relativeTime, freezeTime, FreezeDuration, pointing_altitude, </span>
<span class="sd">                  LP_pointing_altitude, SnapshotSpacing, Snapshot_relativeTime, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode120.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            freezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">            FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the first Snapshot is taken.</span>
<span class="sd">            SnapshotSpacing (int): The time in seconds inbetween sent CMDs for snapshots of individual CCDs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;FullReadout&#39;)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeStart(root, relativeTime, StartTime = freezeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeDuration(root, relativeTime, FreezeDuration = FreezeDuration, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        relativeTime = Commands.TC_pafCCDSnapshot(root, Snapshot_relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        Snapshot_relativeTime = Snapshot_relativeTime + SnapshotSpacing</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = LP_pointing_altitude, Final = LP_pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    #relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode121_macro(root, relativeTime, freezeTime, FreezeDuration, pointing_altitude, </span>
<span class="sd">                  LP_pointing_altitude, SnapshotSpacing, Snapshot_relativeTime, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode121.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            freezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">            FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the Snapshot is taken.</span>
<span class="sd">            SnapshotSpacing (int): The time in seconds inbetween sent CMDs for snapshots of individual CCDs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;FullReadout&#39;)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeStart(root, relativeTime, StartTime = freezeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeDuration(root, relativeTime, FreezeDuration = FreezeDuration, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        relativeTime = Commands.TC_pafCCDSnapshot(root, Snapshot_relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        Snapshot_relativeTime = Snapshot_relativeTime + SnapshotSpacing</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = LP_pointing_altitude, Final = LP_pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    #relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode122_macro(root, relativeTime, freezeTime, FreezeDuration, pointing_altitude, Snapshot_relativeTime, </span>
<span class="sd">                  LP_pointing_altitude, SnapshotSpacing, ExpTimeUV, ExpTimeIR, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode121.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            freezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">            FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the Snapshot is taken.</span>
<span class="sd">            SnapshotSpacing (int): The time in seconds inbetween sent CMDs for snapshots of individual CCDs.</span>
<span class="sd">            ExpTimeUV (int): Exposure time [ms].</span>
<span class="sd">            ExpTimeIR (int): Exposure time [ms].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;BinnedCalibration&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCD_48[&#39;TEXPMS&#39;] = ExpTimeUV</span>
<span class="sd">    CCD_9[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    CCD_6[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeStart(root, relativeTime, StartTime = freezeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeDuration(root, relativeTime, FreezeDuration = FreezeDuration, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        relativeTime = Commands.TC_pafCCDSnapshot(root, Snapshot_relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        Snapshot_relativeTime = Snapshot_relativeTime + SnapshotSpacing</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = LP_pointing_altitude, Final = LP_pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    #relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode123_macro(root, relativeTime, freezeTime, FreezeDuration, pointing_altitude, Snapshot_relativeTime, </span>
<span class="sd">                  LP_pointing_altitude, SnapshotSpacing, ExpTimeUV, ExpTimeIR, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode122.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            freezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">            FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            ExpTimeUV (int): Exposure time [ms].</span>
<span class="sd">            ExpTimeIR (int): Exposure time [ms].</span>
<span class="sd">            Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the Snapshot is taken.</span>
<span class="sd">            SnapshotSpacing (int): The time in seconds inbetween sent CMDs for snapshots of individual CCDs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;LowPixel&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCD_48[&#39;TEXPMS&#39;] = ExpTimeUV</span>
<span class="sd">    CCD_9[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    CCD_6[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeStart(root, relativeTime, StartTime = freezeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeDuration(root, relativeTime, FreezeDuration = FreezeDuration, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        relativeTime = Commands.TC_pafCCDSnapshot(root, Snapshot_relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        Snapshot_relativeTime = Snapshot_relativeTime + SnapshotSpacing</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = LP_pointing_altitude, Final = LP_pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    #relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>



<span class="sd">def Mode124_macro(root, relativeTime, freezeTime, FreezeDuration, pointing_altitude, </span>
<span class="sd">                  LP_pointing_altitude, SnapshotSpacing, Snapshot_relativeTime, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode124.</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            freezeTime (float): Start time of attitude freeze command in on-board time [s].</span>
<span class="sd">            FreezeDuration (int): Duration of freeze [s].</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            Snapshot_relativeTime (float): The relativeTime (time from start of timeline) at which the Snapshot is taken.</span>
<span class="sd">            SnapshotSpacing (int): The time in seconds inbetween sent CMDs for snapshots of individual CCDs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;FullReadout&#39;)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeStart(root, relativeTime, StartTime = freezeTime, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_affArgFreezeDuration(root, relativeTime, FreezeDuration = FreezeDuration, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        relativeTime = Commands.TC_pafCCDSnapshot(root, Snapshot_relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        Snapshot_relativeTime = Snapshot_relativeTime + SnapshotSpacing</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = LP_pointing_altitude, Final = LP_pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode130_macro(root, relativeTime, pointing_altitude, SnapshotSpacing, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode130</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;FullReadout&#39;)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    for CCDSEL in [1,2,4,8,16,32]:</span>
<span class="sd">        Commands.TC_pafCCDSnapshot(root, relativeTime, CCDSEL = CCDSEL, comment = comment)</span>
<span class="sd">        relativeTime = relativeTime + SnapshotSpacing</span>
<span class="sd">        </span>
<span class="sd">    #relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode131_macro(root, relativeTime, pointing_altitude, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode132</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;FullReadout&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, Disregarded = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    TEXPIMS = 60000</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode132_macro(root, relativeTime, pointing_altitude, ExpTimeUV, ExpTimeIR, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode132</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            ExpTimeUV (int): Exposure time of UV CCDs [ms].</span>
<span class="sd">            ExpTimeIR (int): Exposure time of IR CCDs [ms].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;BinnedCalibration&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCD_48[&#39;TEXPMS&#39;] = ExpTimeUV</span>
<span class="sd">    CCD_9[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    CCD_6[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>


<span class="sd">def Mode133_macro(root, relativeTime, pointing_altitude, ExpTimeUV, ExpTimeIR, comment):</span>
<span class="sd">    &#39;&#39;&#39; Macro that corresponds to Mode133</span>
<span class="sd">    </span>
<span class="sd">        Arguments:</span>
<span class="sd">            pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">            ExpTimeUV (int): Exposure time of UV CCDs [ms].</span>
<span class="sd">            ExpTimeIR (int): Exposure time of IR CCDs [ms].</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    CCD_48, CCD_9, CCD_6, CCD_64 = OPT_Config_File.CCD_macro_settings(&#39;LowPixel&#39;)</span>
<span class="sd">    </span>
<span class="sd">    CCD_48[&#39;TEXPMS&#39;] = ExpTimeUV</span>
<span class="sd">    CCD_9[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    CCD_6[&#39;TEXPMS&#39;] = ExpTimeIR</span>
<span class="sd">    </span>
<span class="sd">    CCDSEL, NCCD, TEXPIOFS, TEXPIMS = _Library.SyncArgCalculator(CCD_48, CCD_9, CCD_6, CCD_64)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 2, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafCCDSynchronize(root, relativeTime, CCDSEL = CCDSEL, NCCD = NCCD, </span>
<span class="sd">                                                 TEXPIOFS = TEXPIOFS, comment = comment )</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = CCD_macro(root, relativeTime, CCD_48, CCD_9, CCD_6, CCD_64, TEXPIMS, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_acfLimbPointingAltitudeOffset(root, relativeTime, Initial = pointing_altitude, Final = pointing_altitude, Rate = 0, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    relativeTime = Commands.TC_pafMode(root, relativeTime, mode = 1, comment = comment)</span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="PWRTOGGLE_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.PWRTOGGLE_macro">[docs]</a><span class="k">def</span> <span class="nf">PWRTOGGLE_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CONST</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Macro that corresponds to the PWRTOGGLE CMD.</span>
<span class="sd">    </span>
<span class="sd">    Switches off all CCDs before PWRTOGGLING</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CONST (int): Magical constant.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">127</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="mi">6000</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafPWRToggle</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CONST</span> <span class="o">=</span> <span class="n">CONST</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>



<div class="viewcode-block" id="CCD_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.CCD_macro">[docs]</a><span class="k">def</span> <span class="nf">CCD_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCD_settings</span><span class="p">,</span> <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="mi">60000</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Macro that corresponds to configurating the settings of the CCDs.</span>
<span class="sd">    </span>
<span class="sd">    The settings are set for each corresponding CCDSEL argument. </span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        CCD_settings (:obj:`dict` of int): A dict containing settings for the CCDs.</span>
<span class="sd">        TEXPIMS (int): ExposureIntervalTime for the CCDs in ms.</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">CCDSEL_16</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_16&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_32</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_32&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_1</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_1&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_8</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_8&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_2</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_2&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_4</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_4&#39;</span><span class="p">]</span>
    <span class="n">CCDSEL_64</span> <span class="o">=</span> <span class="n">CCD_settings</span><span class="p">[</span><span class="s1">&#39;CCDSEL_64&#39;</span><span class="p">]</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_16</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_32</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_1</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_8</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_2</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_4</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;PWR&#39;</span><span class="p">],</span> <span class="n">WDW</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;WDW&#39;</span><span class="p">],</span> 
                                          <span class="n">ExpInterval</span> <span class="o">=</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">GAIN</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;GAIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NFLUSH&#39;</span><span class="p">],</span> <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NRSKIP&#39;</span><span class="p">],</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NRBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NROW</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NROW&#39;</span><span class="p">],</span> <span class="n">NCSKIP</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NCSKIP&#39;</span><span class="p">],</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NCBIN&#39;</span><span class="p">],</span> 
                                          <span class="n">NCOL</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NCOL&#39;</span><span class="p">],</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;NCBINFPGA&#39;</span><span class="p">],</span> <span class="n">SIGMODE</span> <span class="o">=</span> <span class="n">CCDSEL_64</span><span class="p">[</span><span class="s1">&#39;SIGMODE&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>


<div class="viewcode-block" id="Limb_functional_test_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Limb_functional_test_macro">[docs]</a><span class="k">def</span> <span class="nf">Limb_functional_test_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">JPEGQ</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Limb_functional_test_macro</span>
<span class="sd">    </span>
<span class="sd">    Arguments: </span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        ExpTime (int): Exposure time in ms</span>
<span class="sd">        JPEGQ (int): The JPEG quality in %</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;40&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;81&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;409&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;64&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;5000&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="s1">&#39;5000&#39;</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;110&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;196&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSnapshot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;63&#39;</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="sd">&#39;&#39;&#39; #Snapshot with on CCD at a time with 5 seconds intervall</span>
<span class="sd">    for CCDSEL in [&#39;1&#39;,&#39;2&#39;,&#39;4&#39;,&#39;8&#39;,&#39;16&#39;,&#39;32&#39;]:</span>
<span class="sd">        </span>
<span class="sd">        relativeTime = TC_pafCCDSnapshot(root, relativeTime, CCDSEL = CCDSEL, comment = &#39;&#39;)</span>
<span class="sd">        relativeTime = str(round(float(relativeTime) + 5-Timeline_settings()[&#39;command_separation&#39;],2))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>



<div class="viewcode-block" id="Photometer_test_1_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Photometer_test_1_macro">[docs]</a><span class="k">def</span> <span class="nf">Photometer_test_1_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">ExpInt</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Photometer_test_1_macro</span>

<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        ExpTime (int): Exposure time in ms</span>
<span class="sd">        ExpInt (int): Exposure interval in ms</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafPM</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">TEXPMS</span><span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="n">ExpInt</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">relativeTime</span></div>



<div class="viewcode-block" id="Nadir_functional_test_macro"><a class="viewcode-back" href="../../../../../Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.html#Operational_Planning_Tool._XMLGenerator.Modes_and_Tests.Macros.Macros.Nadir_functional_test_macro">[docs]</a><span class="k">def</span> <span class="nf">Nadir_functional_test_macro</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">JPEGQ</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Nadir_functional_test</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        root (lxml.etree._Element):  XML tree structure. Main container object for the ElementTree API.</span>
<span class="sd">        relativeTime (float): The relative starting time of the macro with regard to the start of the timeline [s]</span>
<span class="sd">        pointing_altitude (int): The altitude of the tangential point [m].</span>
<span class="sd">        ExpTime (int): Exposure time in ms</span>
<span class="sd">        JPEGQ (int): The JPEG quality in %</span>
<span class="sd">        comment (str): A comment for the macro. Will be printed in the genereated XML-file.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        relativeTime (float): Time in seconds equal to the input &quot;relativeTime&quot; with added delay from the scheduling of commands.</span>
<span class="sd">        &#39;&#39;&#39;</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;40&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;81&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;409&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;64&#39;</span><span class="p">,</span> <span class="n">PWR</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">ExpInterval</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ExpTime</span> <span class="o">=</span> <span class="n">ExpTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">,</span> 
                  <span class="n">NRSKIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">NRBIN</span><span class="o">=</span> <span class="s1">&#39;110&#39;</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="s1">&#39;196&#39;</span><span class="p">,</span> <span class="n">NCOL</span> <span class="o">=</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="n">JPEGQ</span> <span class="o">=</span> <span class="n">JPEGQ</span><span class="p">)</span>
    
    
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="n">pointing_altitude</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">)</span>
        
    <span class="n">relativeTime</span> <span class="o">=</span> <span class="n">Commands</span><span class="o">.</span><span class="n">TC_pafCCDSnapshot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span> <span class="o">=</span> <span class="s1">&#39;64&#39;</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">relativeTime</span></div>



<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def Mode_User_Specified_macro(root, relativeTime, comment = &#39;&#39;):</span>
<span class="sd">    &quot;This is a template for a new macro. Exchange &#39;_User_Specified&#39; for the name of the new macro&quot;</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    return relativeTime</span>
<span class="sd">    </span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../index.html">Operational_Planning_Tool</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Operational_Planning_Tool.html">Operational_Planning_Tool package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../../index.html">Module code</a><ul>
  <li><a href="../../../../Operational_Planning_Tool.html">Operational_Planning_Tool</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, David Sknberg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>