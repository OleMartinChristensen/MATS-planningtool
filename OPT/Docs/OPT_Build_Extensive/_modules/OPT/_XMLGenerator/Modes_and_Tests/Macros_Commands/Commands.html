
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="python 3.7">
  <head>
    <meta charset="utf-8" />
    <title>OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands &#8212; Operational_Planning_Tool  documentation</title>
    <link rel="stylesheet" href="../../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Contain Command functions. Each Command function represent a CMD listed in the &quot;InnoSat Payload Timeline XML Definition&quot; document.</span>

<span class="sd">Add commands to the XML-tree as specified in &quot;InnoSat Payload Timeline XML Definition&quot; document.</span>
<span class="sd">Also checks if parameters given are valid for the CMDs.</span>

<span class="sd">Each Command function has these inputs/outputs in common.</span>

<span class="sd">    **Arguments:**</span>
<span class="sd">        **root** (*lxml.etree.Element*):  XML tree structure. Main container object for the ElementTree API. \n</span>
<span class="sd">        **relativeTime** (*int*): The *relativeTime* of the CMD with regard to the start of the timeline [s]. \n</span>
<span class="sd">        **CMD specific parameters**: A number of CMD specific parameters as defined in &quot;InnoSat Payload Timeline XML Definition&quot; document for each corresponding command. \n</span>
<span class="sd">        **comment** (*str*): A comment regarding the CMD.</span>

<span class="sd">    **Returns:** </span>
<span class="sd">        **incremented_time** (*int*) = The scheduled relativeTime of the command increased by a number equal to *Timeline.settings()[&#39;CMD_separation&#39;]*. </span>
<span class="sd">        This to prevent the command buffer on the satellite from overloading. Note: When *TC_acfLimbPointingAltitudeOffset* is scheduled with Rate = &#39;0&#39;, relativeTime is increased by *Timeline_settings[&#39;pointing_stabilization&#39;].</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span><span class="o">,</span> <span class="nn">importlib</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="k">import</span> <span class="n">sign</span>

<span class="kn">from</span> <span class="nn">OPT</span> <span class="k">import</span> <span class="n">_Globals</span>
<span class="kn">from</span> <span class="nn">OPT._Library</span> <span class="k">import</span> <span class="n">calculate_time_per_row</span>

<span class="n">OPT_Config_File</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Config_File</span><span class="p">)</span>
<span class="c1">#from OPT_Config_File import Timeline_settings, Logger_name, PM_settings</span>

<span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">OPT_Config_File</span><span class="o">.</span><span class="n">Logger_name</span><span class="p">())</span>



<div class="viewcode-block" id="TC_pafMode"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafMode">[docs]</a><span class="k">def</span> <span class="nf">TC_pafMode</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span><span class="p">)</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">mode</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: mode&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafMODE&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;MODE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_acfLimbPointingAltitudeOffset"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_acfLimbPointingAltitudeOffset">[docs]</a><span class="k">def</span> <span class="nf">TC_acfLimbPointingAltitudeOffset</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">Initial</span> <span class="o">=</span> <span class="mi">92500</span><span class="p">,</span> <span class="n">Final</span> <span class="o">=</span> <span class="mi">92500</span><span class="p">,</span> <span class="n">Rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Schedules Pointing Command</span>
<span class="sd">    </span>
<span class="sd">    If Rate == 0 an delay equal to *Timeline_settings[&#39;pointing_stabilization&#39;]* is added to *relativeTime*.</span>
<span class="sd">    If the desired pointing altitude is already set, the maximum allowed TEXPMS is added to *relativeTime*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="o">-</span><span class="mi">60000</span> <span class="o">&lt;=</span> <span class="n">Initial</span> <span class="o">&lt;=</span> <span class="mi">230000</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">Initial</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Initial&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="o">-</span><span class="mi">60000</span> <span class="o">&lt;=</span> <span class="n">Final</span> <span class="o">&lt;=</span> <span class="mi">230000</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">Final</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Final&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="o">-</span><span class="mi">5000</span> <span class="o">&lt;=</span> <span class="n">Rate</span> <span class="o">&lt;=</span> <span class="mi">5000</span> <span class="ow">and</span> <span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">Rate</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">Rate</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">)</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Rate&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Rate</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sign</span><span class="p">(</span><span class="n">Final</span> <span class="o">-</span> <span class="n">Initial</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sign</span><span class="p">(</span><span class="n">Rate</span><span class="p">)):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: sign(Final - Initial) != sign(Rate)&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">current_pointing</span> <span class="o">=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">current_pointing</span>
    
    <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;current_pointing: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">current_pointing</span><span class="p">))</span>
    <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Initial: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Initial</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, Final: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Final</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, Rate: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rate</span><span class="p">))</span>
    
    <span class="c1">#if(current_pointing != Final or current_pointing != Initial ):</span>
    <span class="c1">#    Logger.debug(&#39;Scheduling pointing command&#39;)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_acfLimbPointingAltitudeOffset&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;Initial&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Initial</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;Final&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Final</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;Rate&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rate</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">Rate</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">):</span>
        <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
        <span class="n">_Globals</span><span class="o">.</span><span class="n">current_pointing</span><span class="o">=</span> <span class="kc">None</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Rate != 0, meaning a sweep is scheduled. Next CMD is only staggered by Timeline_settings[&quot;CMD_separation&quot;]&#39;</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">current_pointing</span> <span class="o">==</span> <span class="n">Final</span> <span class="ow">and</span> <span class="n">current_pointing</span> <span class="o">==</span> <span class="n">Initial</span> <span class="p">):</span>
        <span class="n">_Globals</span><span class="o">.</span><span class="n">current_pointing</span><span class="o">=</span> <span class="n">Final</span>
        <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span> <span class="o">+</span> <span class="mi">32</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Satellite is already orientated the right way. Next CMD is staggered by the same amount as the the maximum allowed TEXPMS&#39;</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">Final</span> <span class="o">==</span> <span class="n">Initial</span> <span class="ow">and</span> <span class="n">Rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">_Globals</span><span class="o">.</span><span class="n">current_pointing</span><span class="o">=</span> <span class="n">Final</span>
        <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;pointing_stabilization&#39;</span><span class="p">]</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Satellite is not orientated the right way. Next CMD is staggered by Timeline_settings[&quot;pointing_stabilization&quot;]&#39;</span><span class="p">)</span>
        
    <span class="c1">#else:</span>
    <span class="c1">#    Logger.debug(&#39;Skipping pointing command as satellite is already oriented the desired way&#39;)</span>
    <span class="c1">#    incremented_time = relativeTime</span>
    
    
    <span class="c1">#incremented_time = relativeTime+_Globals.Timeline_settings[&#39;CMD_separation&#39;]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
<div class="viewcode-block" id="TC_affArgFreezeStart"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_affArgFreezeStart">[docs]</a><span class="k">def</span> <span class="nf">TC_affArgFreezeStart</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">StartTime</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="s2">&quot;Within the years 2019-2100&quot;</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1198843200</span> <span class="o">&lt;</span> <span class="n">StartTime</span> <span class="o">&lt;=</span> <span class="mi">1893067200</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: StartTime&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_affArgFreezeStart&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;StartTime&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">StartTime</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_affArgFreezeDuration"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_affArgFreezeDuration">[docs]</a><span class="k">def</span> <span class="nf">TC_affArgFreezeDuration</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">FreezeDuration</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">FreezeDuration</span> <span class="o">&lt;=</span> <span class="mi">3600</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative FreezeDuration or exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_affArgFreezeDuration&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;FreezeDuration&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">FreezeDuration</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    

<div class="viewcode-block" id="TC_acfArgEnableYawComp"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_acfArgEnableYawComp">[docs]</a><span class="k">def</span> <span class="nf">TC_acfArgEnableYawComp</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">EnableYawComp</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">EnableYawComp</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">EnableYawComp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: EnableYawComp&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
        
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_acfArgEnableYawComp&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;EnableYawComp&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">EnableYawComp</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>


<div class="viewcode-block" id="TC_pafPWRToggle"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafPWRToggle">[docs]</a><span class="k">def</span> <span class="nf">TC_pafPWRToggle</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CONST</span> <span class="o">=</span> <span class="mi">165</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">CONST</span> <span class="o">==</span> <span class="mi">165</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CONST</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CONST&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafPWRTOGGLE&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CONST&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CONST</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_pafUpload"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafUpload">[docs]</a><span class="k">def</span> <span class="nf">TC_pafUpload</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">PINDEX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PTOTAL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WFLASH</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NIMG</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">IMG</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">PINDEX</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">PINDEX</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: PINDEX&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">PTOTAL</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">PTOTAL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: PTOTAL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">PINDEX</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">PTOTAL</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: PINDEX or PTOTAL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">NIMG</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">IMG</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NIMG</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NIMG&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">WFLASH</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">WFLASH</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: WFLASH&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafUPLOAD&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;PINDEX&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">PINDEX</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;PTOTAL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">PTOTAL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;WFLASH&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">WFLASH</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NIMG&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NIMG</span><span class="p">)</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">for</span> <span class="n">Image</span> <span class="ow">in</span> <span class="n">IMG</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Image</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">Image</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">):</span>
             <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Image&#39;</span><span class="p">)</span>
             <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;IMG&quot;</span><span class="p">)</span>
        <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Image</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
<div class="viewcode-block" id="TC_pafHTR"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafHTR">[docs]</a><span class="k">def</span> <span class="nf">TC_pafHTR</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">HTRSEL</span><span class="p">,</span> <span class="n">SET</span><span class="p">,</span> <span class="n">PVALUE</span><span class="p">,</span> <span class="n">IVALUE</span><span class="p">,</span> <span class="n">DVALUE</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">HTRSEL</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="ow">or</span> <span class="mi">64</span> <span class="o">&lt;=</span> <span class="n">HTRSEL</span> <span class="o">&lt;=</span> <span class="mi">67</span> <span class="ow">or</span> <span class="mi">128</span> <span class="o">&lt;=</span> <span class="n">HTRSEL</span> <span class="o">&lt;=</span> <span class="mi">131</span> <span class="ow">or</span> <span class="mi">192</span> <span class="o">&lt;=</span> <span class="n">HTRSEL</span> <span class="o">&lt;=</span> <span class="mi">195</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">HTRSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: HTRSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">86</span> <span class="o">&lt;=</span> <span class="n">SET</span> <span class="o">&lt;=</span> <span class="mi">2285</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">SET</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: 86 &gt; SET or SET &gt; 2285&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">PVALUE</span> <span class="o">&lt;=</span> <span class="mi">65536</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">PVALUE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: PVALUE&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">IVALUE</span> <span class="o">&lt;=</span> <span class="mi">65536</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">IVALUE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: IVALUE&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">DVALUE</span> <span class="o">&lt;=</span> <span class="mi">65536</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">DVALUE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: DVALUE&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafHTR&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;HTRSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">HTRSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;SET&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">SET</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;PVALUE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">PVALUE</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;IVALUE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">IVALUE</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;DVALUE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">DVALUE</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_pafCCDMain"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDMain">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDMain</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">PWR</span><span class="p">,</span> <span class="n">TEXPMS</span><span class="p">,</span> <span class="n">TEXPIMS</span><span class="p">,</span> <span class="n">NRSKIP</span><span class="p">,</span> <span class="n">NRBIN</span><span class="p">,</span>
                  <span class="n">NROW</span><span class="p">,</span> <span class="n">NCBIN</span><span class="p">,</span> <span class="n">NCOL</span><span class="p">,</span> <span class="n">WDW</span><span class="p">,</span> <span class="n">JPEGQ</span><span class="p">,</span> <span class="n">SYNC</span><span class="p">,</span> 
                  <span class="n">NCBINFPGA</span><span class="p">,</span> <span class="n">SIGMODE</span><span class="p">,</span> <span class="n">GAIN</span><span class="p">,</span> 
                  <span class="n">NFLUSH</span><span class="p">,</span> <span class="n">NCSKIP</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">PWR</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">PWR</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: PWR&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">NRSKIP</span> <span class="o">&lt;=</span> <span class="mi">510</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NRSKIP</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NRSKIP&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">NRBIN</span> <span class="o">&lt;=</span> <span class="mi">63</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NRBIN</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NRBIN&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">NROW</span> <span class="o">&lt;=</span> <span class="mi">511</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NROW&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">NCSKIP</span> <span class="o">&lt;=</span> <span class="mi">2046</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NCSKIP</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NCSKIP&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">NCBIN</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NCBIN</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NCBIN&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">NCOL</span> <span class="o">&lt;=</span> <span class="mi">2047</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NCOL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NCOL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">NCBINFPGA</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NCBINFPGA</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NCBINFPGA, if NCBINFPGA=8 then the CRB may stop working&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">SIGMODE</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">SIGMODE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: SIGMODE, if SIGMODE=0 then the CCDs may be unstable and stop working.&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">WDW</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="ow">or</span> <span class="n">WDW</span> <span class="o">==</span> <span class="mi">128</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">WDW</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: WDW&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">WDW</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">JPEGQ</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: WDW == 7, but JPEGQ &lt;= 100&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">WDW</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">JPEGQ</span> <span class="o">&gt;=</span> <span class="mi">101</span><span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: 0 &lt;= WDW &lt;= 4, but JPEGQ &gt;= 101&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">JPEGQ</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">JPEGQ</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: JPEGQ&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">GAIN</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">GAIN</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: GAIN&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">NFLUSH</span> <span class="o">&lt;=</span> <span class="mi">1023</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NFLUSH</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NFLUSH&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">NROW</span> <span class="o">*</span> <span class="n">NRBIN</span> <span class="o">+</span> <span class="n">NRSKIP</span> <span class="o">&lt;=</span>  <span class="mi">511</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: NROW * NRBIN + NRSKIP exceeds 511&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="p">(</span><span class="n">NCOL</span><span class="p">)</span> <span class="o">*</span> <span class="n">NCBIN</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">NCBINFPGA</span> <span class="o">+</span> <span class="n">NCSKIP</span> <span class="o">&lt;=</span> <span class="mi">2047</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: (NCOL+1) * NCBIN * 2^NCBINFPGA + NCSKIP exceeds 2047&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
        
    
    <span class="n">T_readout</span><span class="p">,</span> <span class="n">T_delay</span><span class="p">,</span> <span class="n">T_Extra</span> <span class="o">=</span> <span class="n">calculate_time_per_row</span><span class="p">(</span><span class="n">NCOL</span> <span class="o">=</span> <span class="n">NCOL</span><span class="p">,</span> <span class="n">NCBIN</span> <span class="o">=</span> <span class="n">NCBIN</span><span class="p">,</span> <span class="n">NCBINFPGA</span> <span class="o">=</span> <span class="n">NCBINFPGA</span><span class="p">,</span> 
                                                         <span class="n">NRSKIP</span> <span class="o">=</span> <span class="n">NRSKIP</span><span class="p">,</span> <span class="n">NROW</span> <span class="o">=</span> <span class="n">NROW</span><span class="p">,</span> <span class="n">NRBIN</span> <span class="o">=</span> <span class="n">NRBIN</span><span class="p">,</span> <span class="n">NFLUSH</span> <span class="o">=</span> <span class="n">NFLUSH</span><span class="p">)</span>
    <span class="n">ReadOutTime</span> <span class="o">=</span> <span class="n">T_readout</span> <span class="o">+</span> <span class="n">T_delay</span> <span class="o">+</span> <span class="n">T_Extra</span>
    <span class="c1">#Logger.debug(&#39;ReadOutTime = &#39;+str(ReadOutTime))</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">TEXPMS</span> <span class="o">&lt;=</span> <span class="mi">32000</span> <span class="ow">and</span> <span class="n">TEXPMS</span> <span class="o">+</span> <span class="n">ReadOutTime</span> <span class="o">&lt;</span> <span class="n">TEXPIMS</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: 32000 &lt; TEXPMS &lt; 0 or TEXPMS + ReadOutTime &gt; TEXPIMS&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">TEXPMS</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">TEXPIMS</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: TEXPMS or TEXPIMS is not an integer&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCD&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;PWR&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">PWR</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;WDW&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">WDW</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;JPEGQ&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">JPEGQ</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;SYNC&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">SYNC</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TEXPIMS&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TEXPIMS</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TEXPMS&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TEXPMS</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;GAIN&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">GAIN</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NFLUSH&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NFLUSH</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NRSKIP&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NRSKIP</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NRBIN&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NRBIN</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NROW&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NROW</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NCSKIP&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NCSKIP</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NCBIN&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NCBIN</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NCOL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NCOL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NCBINFPGA&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NCBINFPGA</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;SIGMODE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">SIGMODE</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    

<div class="viewcode-block" id="TC_pafCCDSYNCHRONIZE"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDSYNCHRONIZE">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDSYNCHRONIZE</span><span class="p">(</span> <span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NCCD</span><span class="p">,</span> <span class="n">TEXPIOFS</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="n">CCDSEL</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">]</span>  <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">NCCD</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">NCCD</span> <span class="o">==</span> <span class="nb">bin</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NCCD</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: More than 7 CCDs chosen (or less than 2) or NCCD does not coincide with CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEXPIOFS</span><span class="p">)</span> <span class="o">==</span> <span class="n">NCCD</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Number of CCDs (NCCD) does not coincide with the number of time-offsets (TEXPIOFS).&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">for</span> <span class="n">TEXPIOFS_value</span> <span class="ow">in</span> <span class="n">TEXPIOFS</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">TEXPIOFS_value</span> <span class="o">&lt;=</span> <span class="mi">12000</span> <span class="p">):</span>
            <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: 0 &gt; TEXPIOFS_value, TEXPIOFS_value &gt; 12000&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;CCDSEL: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">))</span>
    <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;NCCD: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">NCCD</span><span class="p">))</span>
    <span class="n">Logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;TEXPIOFS: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">TEXPIOFS</span><span class="p">))</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDSYNCHRONIZE&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NCCD&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NCCD</span><span class="p">)</span>
    
    <span class="n">Leading_CCD_selected</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">TimeOffset</span> <span class="ow">in</span> <span class="n">TEXPIOFS</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">TimeOffset</span> <span class="o">&lt;=</span> <span class="mi">12000</span> <span class="ow">and</span> <span class="n">TimeOffset</span><span class="o">/</span><span class="mi">10</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="n">TimeOffset</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">TimeOffset</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
             <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: TEXPIOFS&#39;</span><span class="p">)</span>
             <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">TimeOffset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">Leading_CCD_selected</span> <span class="o">=</span> <span class="kc">True</span>
            
        <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TEXPIOFS&quot;</span><span class="p">)</span>
        <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TimeOffset</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">Leading_CCD_selected</span> <span class="o">==</span> <span class="kc">True</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Any TEXPIOFS not set to 0 -&gt; No leading CCD selected&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
        
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>

    
<div class="viewcode-block" id="TC_pafCCDBadColumn"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDBadColumn">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDBadColumn</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">NBC</span><span class="p">,</span> <span class="n">BC</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">NBC</span> <span class="o">&lt;=</span> <span class="mi">63</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">NBC</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: More than 63 BadColumns chosen (or less than 0)&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">BC</span><span class="p">)</span> <span class="o">==</span> <span class="n">NBC</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: Number of BadColumns (NBC) does not coincide with Bad Column (BC).&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
        
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDBadColumn&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;NBC&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">NBC</span><span class="p">)</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">BadColumn</span> <span class="ow">in</span> <span class="n">BC</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">4</span> <span class="o">&lt;=</span> <span class="n">BadColumn</span> <span class="o">&lt;=</span> <span class="mi">2047</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">BadColumn</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">):</span>
             <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: BC&#39;</span><span class="p">)</span>
             <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;BC&quot;</span><span class="p">)</span>
        <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">BadColumn</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_pafCCDFlushBadColumns"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDFlushBadColumns">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDFlushBadColumns</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDFlushBadColumns&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_pafCCDBIAS"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDBIAS">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDBIAS</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">VGATE</span><span class="p">,</span> <span class="n">VSUBST</span><span class="p">,</span> <span class="n">VRD</span><span class="p">,</span> <span class="n">VOD</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">VGATE</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">VSUBST</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">VRD</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">VOD</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="ow">and</span> 
            <span class="nb">type</span><span class="p">(</span><span class="n">VGATE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span>  <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">VSUBST</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span>  <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">VRD</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span>  <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">VOD</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDBIAS values are not set as integers, or too high or low&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
        
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDBIAS&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;VGATE&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">VGATE</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;VSUBST&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">VSUBST</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;VRD&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">VRD</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;VOD&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">VOD</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    
    
<div class="viewcode-block" id="TC_pafCCDSnapshot"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDSnapshot">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDSnapshot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDSNAPSHOT&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>


<div class="viewcode-block" id="TC_pafCCDTRANSPARENTCMD"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafCCDTRANSPARENTCMD">[docs]</a><span class="k">def</span> <span class="nf">TC_pafCCDTRANSPARENTCMD</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">CHAR</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">CHAR</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CHAR&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafCCDTRANSPARENTCMD&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CHAR&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">CHAR</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
    

<div class="viewcode-block" id="TC_pafDbg"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafDbg">[docs]</a><span class="k">def</span> <span class="nf">TC_pafDbg</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">CCDSEL</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">CCDSEL</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: CCDSEL&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafDbg&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;CCDSEL&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">CCDSEL</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>


<div class="viewcode-block" id="TC_pafPM"><a class="viewcode-back" href="../../../../../OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.html#OPT._XMLGenerator.Modes_and_Tests.Macros_Commands.Commands.TC_pafPM">[docs]</a><span class="k">def</span> <span class="nf">TC_pafPM</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">relativeTime</span><span class="p">,</span> <span class="n">TEXPMS</span> <span class="o">=</span> <span class="n">OPT_Config_File</span><span class="o">.</span><span class="n">PM_settings</span><span class="p">()[</span><span class="s1">&#39;TEXPMS&#39;</span><span class="p">],</span> <span class="n">TEXPIMS</span> <span class="o">=</span> <span class="n">OPT_Config_File</span><span class="o">.</span><span class="n">PM_settings</span><span class="p">()[</span><span class="s1">&#39;TEXPIMS&#39;</span><span class="p">],</span> <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">&lt;=</span> <span class="n">relativeTime</span> <span class="o">&lt;=</span> <span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: negative relativeTime, decreasing relativeTime, exceeding timeline duration&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">TEXPMS</span> <span class="ow">and</span> <span class="n">TEXPIMS</span> <span class="o">&gt;=</span> <span class="n">TEXPMS</span> <span class="o">+</span> <span class="mi">500</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: TEXPMS is negative or TEXPMS is less than 500ms larger then TEXPIMS&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">TEXPMS</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">TEXPIMS</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="p">):</span>
        <span class="n">Logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Invalid argument: TEXPMS or TEXPIMS is not an integer&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TC_pafPM&quot;</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;relativeTime&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relativeTime</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">comment</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;tcArguments&#39;</span><span class="p">)</span>
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TEXPMS&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TEXPMS</span><span class="p">)</span>
    
    <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;tcArgument&#39;</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;TEXPIMS&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TEXPIMS</span><span class="p">)</span>
    
    <span class="n">incremented_time</span> <span class="o">=</span> <span class="n">relativeTime</span><span class="o">+</span><span class="n">_Globals</span><span class="o">.</span><span class="n">Timeline_settings</span><span class="p">[</span><span class="s1">&#39;CMD_separation&#39;</span><span class="p">]</span>
    <span class="n">_Globals</span><span class="o">.</span><span class="n">latestRelativeTime</span> <span class="o">=</span> <span class="n">relativeTime</span>
    
    <span class="k">return</span> <span class="n">incremented_time</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../index.html">Operational_Planning_Tool</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../OPT.html">OPT package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../../index.html">Module code</a><ul>
  <li><a href="../../../../OPT.html">OPT</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, David Skånberg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>